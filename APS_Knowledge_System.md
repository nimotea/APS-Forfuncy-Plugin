# APS 生产计划与排程知识体系指南

## 1. 核心概念辨析：排程 (Planning) vs 排产 (Scheduling)

在专业领域（APICS/ASCM 标准）中，这两者有着明确的职能界限与分工。

| 维度         | **排程 (Planning / 宏观计划)**         | **排产 (Scheduling / 微观调度)**     |
| :----------- | :------------------------------------- | :----------------------------------- |
| **英文术语** | Master Planning / RCCP                 | Detailed Scheduling / SFC            |
| **时间跨度** | 中长期（周、月、季度）                 | 短期（小时、班次、日、周）           |
| **颗粒度**   | **桶 (Bucket)**：以天/周为单位看总量。 | **点 (Point)**：精确到分秒看序列。   |
| **核心对象** | 产品族、虚拟件、关键资源组。           | 具体工单 (MO)、设备、模具、人员。    |
| **决策目标** | **平衡供需**：物料够不够？产能缺不缺？ | **执行效率**：怎么干最快？怎么齐套？ |
| **典型输出** | MPS 主计划、负荷直方图、外协计划。     | 派工单、机台作业甘特图。             |

> **💡 术语说明**：各企业习惯不同，本指南统一定义“排程”为宏观计划层，“排产”为微观执行层。



---

## 2. APS 计划分级体系 (The Hierarchy of Planning)

工业界通常将计划分为 L1 到 L4 四个层级，我们的插件定位于 **L1.5**，是连接宏观与微观的关键。

### **L1: 战略与销售运营规划 (S&OP / MPS)**
* **输入**：销售预测、年度订单、库存策略。
* **逻辑**：**无限能力**。假设产能无限，计算“为了满足销售应产多少”。

### **L1.5: 粗能力计划 (RCCP) —— *本插件定位***
* **输入**：MPS、关键资源组产能、**关键物料齐套性预判**。
* **逻辑**：**有限能力（桶算法）**。
    * 将任务丢入资源桶，验证是否溢出。
    * 执行**削峰填谷**（平滑负荷）或输出超载报警。
* **价值**：确保计划可行。若 RCCP 失败，下游排产将失去意义。

### **L2: 物料需求计划 (MRP)**
* **输入**：MPS/RCCP 确认后的计划、BOM、库存状况。
* **逻辑**：计算物料缺口，生成采购申请 (PR) 和建议工单。

### **L3: 详细能力排产 (CRP / Detailed Scheduling)**
* **逻辑**：**有限能力（时序算法）**。
    * 精确到分钟，考虑换模成本、最小批量、工序并行等微观约束。
* **算法**：规则启发式 (Heuristics)、遗传算法 (GA) 等。

### **L4: 现场执行 (Execution / MES)**
* **内容**：实时报工与异常反馈。反馈进度至 L3 层级进行滚动重排。

---

## 3. 主流算法与适用场景

### **3.1 核心算法策略对比**

| 算法策略           | 原理                               | 适用场景                       | 优缺点                             |
| :----------------- | :--------------------------------- | :----------------------------- | :--------------------------------- |
| **无限能力倒排**   | 根据交期倒推开工日，统计负荷。     | 产能弹性大或寻找瓶颈时。       | ✅ 直观暴露缺口；❌ 结果不可执行。   |
| **有限能力顺排**   | 从“现在”开始寻找空闲时段塞入工单。 | **L1.5 / L3 主流**。           | ✅ 结果必可行；❌ 可能导致交期延误。 |
| **瓶颈排程 (DBR)** | 只排瓶颈资源，非瓶颈资源配合瓶颈。 | 生产线有明显瓶颈（如热处理）。 | ✅ 产出最大化；❌ 非瓶颈利用率低。   |

### **3.2 具体计算模型**

1.  **桶算法 (Bucket Algorithm) —— *L1.5 插件核心***
    * **描述**：将时间划分为桶（天/周），仅看桶内容量是否超标。
    * **优点**：计算极快，逻辑简单，容错率高。
    * **缺点**：无法反映换产顺序（如模具切换）的时间损耗。

2.  **资源概况法 (Resource Profile)**
    * **描述**：考虑工单在时间轴上的百分比分布（如第一天占 20% 负荷）。
    * **适用**：大型装备制造、造船。

3.  **事件驱动模拟 (DES)**
    * **描述**：模拟上料、加工、故障等每一个原子动作。
    * **适用**：L3 级详细排产。

4.  **数学规划 (Linear Programming)**
    * **描述**：建立方程组求全局最优解。
    * **适用**：流程行业（化工、炼钢）等成本敏感场景。

---

## 4. 常见误区 (Pitfalls)

1.  **计划断层**：缺乏宏观 RCCP，直接从订单跳到 L3 详细排产。由于宏观产能不足，微观排产注定成为频繁变动的“救火”工具。
2.  **追求最优解**：试图在干扰频发的车间求得理论最优。实际应追求**可行解 (Feasible)** 与**鲁棒性 (Robust)**。
3.  **垃圾进垃圾出 (GIGO)**：缺乏标准工时或**资源日历维护**（如忽略设备维修）。数据失真会导致排产结果完全脱离实际。

---

## 5. APS 软件能力成熟度模型 (Software Maturity)

### 5.1 业务层级 vs 软件能力

| 维度         | **业务层级 (Section 2)**    | **软件能力 (Section 5)**      |
| :----------- | :-------------------------- | :---------------------------- |
| **核心视角** | **管什么？** (组织决策层级) | **怎么算？** (算法智能化程度) |
| **切分依据** | 决策周期、时间跨度。        | 约束数量、计算精度。          |
| **典型问题** | “这个月产能够不够？”        | “机器坏了，后单顺延几分钟？”  |

### 5.2 能力分级详解

| 等级     | 名称             | 核心逻辑      | 特点与功能                                   | 输出物                       |
| :------- | :--------------- | :------------ | :------------------------------------------- | :--------------------------- |
| **L1**   | **静态排序**     | 优先级排序。  | 无时间轴，无限产能假定。                     | 排序清单。                   |
| **L1.5** | **粗能力排程**   | **桶算法**。  | **宏观有限产能**，自动削峰填谷，识别休息日。 | **资源负荷图**、建议完工日。 |
| **L2**   | **有限能力排程** | **物理约束**  | 微观推挤效应，精确避开休息时段。             | 设备负荷甘特图。             |
| **L3**   | **约束同步排程** | **多维耦合**  | 多工序联动，齐套性检查，人机料法协同。       | 执行级作业指令。             |
| **L4**   | **动态寻优**     | **AI 自适应** | 自动重排 (What-if)，多目标寻优。             | 智能调度方案。               |

---

## 6. 总结

* **排程 (Planning)** 是做正确的事（平衡供需，确保目标可行）。
* **排产 (Scheduling)** 是正确地做事（优化执行，确保效率最高）。
* 本 **L1.5 插件** 是连接两者的桥梁，通过高效的**桶算法**，在低成本下实现产能的可视化与预警。